library(lpSolve)

#variable
#amount of gallons in JAN,FEB,MARCH
#a -> Hamlin,Brazil
#b -> Mosambi,India
#(and so on),...
#JAN: a1,b1,c1,d1,e1,f1,g1,h1,i1,j1,k1
#FEB: a2,b2,...
#MAR: a3,b3,...
#<<objective function>>:
#minimize price and shippingcost: 
#(1) 500*(a1+a2+a3) + 310*(b1+b2+b3) + 750*(c1+c2+c3) + 600*(d1+d2+d3) + 600*(e1+e2+e3) + 625*(f1+f2+f3) + 440*(g1+g2+g3) + 600*(h1+h2+h3) + 300*(i1+i2+i3) + 460*(j1+j2+j3) + 505*(k1+k2+k3) 
#(2) 100*(a1+a2+a3) + 150*(b1+b2+b3) + 0 + 60*(d1+d2+d3) + 75*(e1+e2+e3) + 50*(f1+f2+f3) + 120*(g1+g2+g3) + 110*(h1+h2+h3) + 90*(i1+i2+i3) + 130*(j1+j2+j3) + 115*(k1+k2+k3) 
#subjected to:
#(total orders meet requirement)
#(1) a1 + b1 + c1 + d1 + e1 + f1 + g1 + h1 + i1 + j1 + k1 == 600
#(2) a2 + b2 + c2 + d2 + e2 + f2 + g2 + h2 + i2 + j2 + k2 == 600
#(3) a3 + b3 + c3 + d3 + e3 + f3 + g3 + h3 + i3 + j3 + k3 == 700
#(Valencia orders meet tax incentive)
#(4) c1 >= 240
#(5) c2 >= 240
#(6) c3 >= 280
#(Quality constraints)
#(7) BAR
#    10.5*a1 + 6.5*b1 + 12*c1 + 11*d1 + 12*e1 + 10*f1 + 9*g1 + 15*h1 + 8*i1 + 13*j1 + 14*k1 >= 11.5*600
#    10.5*a1 + 6.5*b1 + 12*c1 + 11*d1 + 12*e1 + 10*f1 + 9*g1 + 15*h1 + 8*i1 + 13*j1 + 14*k1 <= 12.5*600
#    repeat for FEB(2) and MARCH(3)...
#(8) Acid
#(9) Astringency
#(10) Color
#(11) orders of each orange providers not exceed
#   a1 + a2 + a3 <= 672
#   b1 + b2 + b3 <= 400
#   ,...

#variables order [a1,b1,c1,...,a2,b2,c2,...,a3,b3,c3,...]
cost_coefs = c(500,310,750,600,600,625,440,600,300,460,505)
ship_coefs = c(100,150,0,60,75,50,120,110,90,130,115)
total_coefs = cost_coefs + ship_coefs

f.obj = c(rep(total_coefs,times=3))
f.con = matrix(c(
  rep(1,times=11),rep(0,times=11),rep(0,times=11),
  rep(0,times=11),rep(1,times=11),rep(0,times=11),
  rep(0,times=11),rep(0,times=11),rep(1,times=11),
  c(0,0,1,0,0,0,0,0,0,0,0),rep(0,times=11),rep(0,times=11),
  rep(0,times=11),c(0,0,1,0,0,0,0,0,0,0,0),rep(0,times=11),
  rep(0,times=11),rep(0,times=11),c(0,0,1,0,0,0,0,0,0,0,0),
  c(10.5,6.5,12,11,12,10,9,15,8,13,14),rep(0,times=22),
  c(10.5,6.5,12,11,12,10,9,15,8,13,14),rep(0,times=22),
  rep(0,times=11),c(10.5,6.5,12,11,12,10,9,15,8,13,14),rep(0,times=11),
  rep(0,times=11),c(10.5,6.5,12,11,12,10,9,15,8,13,14),rep(0,times=11),
  rep(0,times=22),c(10.5,6.5,12,11,12,10,9,15,8,13,14),
  rep(0,times=22),c(10.5,6.5,12,11,12,10,9,15,8,13,14),
  c(0.6,1.4,0.95,1.0,0.7,0.7,1.35,1.1,1.3,1.3,0.5),rep(0,times=22),
  c(0.6,1.4,0.95,1.0,0.7,0.7,1.35,1.1,1.3,1.3,0.5),rep(0,times=22),
  rep(0,times=11),c(0.6,1.4,0.95,1.0,0.7,0.7,1.35,1.1,1.3,1.3,0.5),rep(0,times=11),
  rep(0,times=11),c(0.6,1.4,0.95,1.0,0.7,0.7,1.35,1.1,1.3,1.3,0.5),rep(0,times=11),
  rep(0,times=22),c(0.6,1.4,0.95,1.0,0.7,0.7,1.35,1.1,1.3,1.3,0.5),
  rep(0,times=22),c(0.6,1.4,0.95,1.0,0.7,0.7,1.35,1.1,1.3,1.3,0.5),
  c(3,7,3,3,1,1,7,4,8,3,3),rep(0,times=22),
  c(3,7,3,3,1,1,7,4,8,3,3),rep(0,times=22),
  rep(0,times=11),c(3,7,3,3,1,1,7,4,8,3,3),rep(0,times=11),
  rep(0,times=11),c(3,7,3,3,1,1,7,4,8,3,3),rep(0,times=11),
  rep(0,times=22),c(3,7,3,3,1,1,7,4,8,3,3),
  rep(0,times=22),c(3,7,3,3,1,1,7,4,8,3,3),
  c(3,1,3,5,5,5,3,8,3,5,9),rep(0,times=22),
  c(3,1,3,5,5,5,3,8,3,5,9),rep(0,times=22),
  rep(0,times=11),c(3,1,3,5,5,5,3,8,3,5,9),rep(0,times=11),
  rep(0,times=11),c(3,1,3,5,5,5,3,8,3,5,9),rep(0,times=11),
  rep(0,times=22),c(3,1,3,5,5,5,3,8,3,5,9),
  rep(0,times=22),c(3,1,3,5,5,5,3,8,3,5,9),
  c(1,0,0,0,0,0,0,0,0,0,0),c(1,0,0,0,0,0,0,0,0,0,0),c(1,0,0,0,0,0,0,0,0,0,0),
  c(0,1,0,0,0,0,0,0,0,0,0),c(0,1,0,0,0,0,0,0,0,0,0),c(0,1,0,0,0,0,0,0,0,0,0),
  c(0,0,1,0,0,0,0,0,0,0,0),c(0,0,1,0,0,0,0,0,0,0,0),c(0,0,1,0,0,0,0,0,0,0,0),
  c(0,0,0,1,0,0,0,0,0,0,0),c(0,0,0,1,0,0,0,0,0,0,0),c(0,0,0,1,0,0,0,0,0,0,0),
  c(0,0,0,0,1,0,0,0,0,0,0),c(0,0,0,0,1,0,0,0,0,0,0),c(0,0,0,0,1,0,0,0,0,0,0),
  c(0,0,0,0,0,1,0,0,0,0,0),c(0,0,0,0,0,1,0,0,0,0,0),c(0,0,0,0,0,1,0,0,0,0,0),
  c(0,0,0,0,0,0,1,0,0,0,0),c(0,0,0,0,0,0,1,0,0,0,0),c(0,0,0,0,0,0,1,0,0,0,0),
  c(0,0,0,0,0,0,0,1,0,0,0),c(0,0,0,0,0,0,0,1,0,0,0),c(0,0,0,0,0,0,0,1,0,0,0),
  c(0,0,0,0,0,0,0,0,1,0,0),c(0,0,0,0,0,0,0,0,1,0,0),c(0,0,0,0,0,0,0,0,1,0,0),
  c(0,0,0,0,0,0,0,0,0,1,0),c(0,0,0,0,0,0,0,0,0,1,0),c(0,0,0,0,0,0,0,0,0,1,0),
  c(0,0,0,0,0,0,0,0,0,0,1),c(0,0,0,0,0,0,0,0,0,0,1),c(0,0,0,0,0,0,0,0,0,0,1)
  ),nrow=41,byrow=TRUE)
f.dir = c(
  "==",
  "==",
  "==",
  ">=",
  ">=",
  ">=",
  ">=",
  "<=",
  ">=",
  "<=",
  ">=",
  "<=",
  ">=",
  "<=",
  ">=",
  "<=",
  ">=",
  "<=",
  ">=",
  "<=",
  ">=",
  "<=",
  ">=",
  "<=",
  ">=",
  "<=",
  ">=",
  "<=",
  ">=",
  "<=",
  "<=",
  "<=",
  "<=",
  "<=",
  "<=",
  "<=",
  "<=",
  "<=",
  "<=",
  "<=",
  "<="
)
f.rhs = c(
  600,
  600,
  700,
  240,
  240,
  280,
  11.5*600,
  12.5*600,
  11.5*600,
  12.5*600,
  11.5*700,
  12.5*700,
  0.0075*600*100,
  0.01*600*100,
  0.0075*600*100,
  0.01*600*100,
  0.0075*700*100,
  0.01*700*100,
  0,
  4*600,
  0,
  4*600,
  0,
  4*700,
  4.5*600,
  5.5*600,
  4.5*600,
  5.5*600,
  4.5*700,
  5.5*700,
  672,
  400,
  1200,
  168,
  84,
  210,
  588,
  168,
  300,
  210,
  180
)
 
lp_solve = lp("min",f.obj,f.con,f.dir,f.rhs)
#not exacty the same as in the book
lp_solve$solution
